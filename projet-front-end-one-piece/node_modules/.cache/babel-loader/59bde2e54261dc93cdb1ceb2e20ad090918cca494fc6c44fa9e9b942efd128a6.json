{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import Navigation from\"../components/Navigation\";import axios from\"axios\";import{jwtDecode}from\"jwt-decode\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profil=()=>{const[userData,setUserData]=useState(null);useEffect(()=>{const token=localStorage.getItem(\"token\");if(!token){// Si aucun token, redirige vers la page de connexion ou traite l'absence de token\nconsole.error(\"Aucun token trouvé, redirection vers la page de connexion\");localStorage.removeItem(\"token\");window.location.href=\"/connexion\";return;}try{const decodedToken=jwtDecode(token);const pseudo=decodedToken.pseudo;// Exemple de vérification du token\naxios.get(`http://192.168.1.16:3001/user/${pseudo}`,{headers:{Authorization:`Bearer ${token}`}}).then(response=>{setUserData(response.data);}).catch(error=>{console.error(\"Erreur lors de la récupération du profil:\",error);localStorage.removeItem(\"token\");window.location.href=\"/connexion\";});}catch(error){console.error(\"Erreur lors du décodage du token:\",error);localStorage.removeItem(\"token\");window.location.href=\"/connexion\";}},[]);// Dépendances vides, s'exécute une seule fois au montage du composant\n// Afficher les informations de l'utilisateur\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navigation,{}),/*#__PURE__*/_jsx(\"h1\",{children:\"Profil\"}),userData?/*#__PURE__*/_jsxs(\"div\",{className:\"profil\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Nom: \",userData.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Pr\\xE9nom: \",userData.firstname]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Pseudo: \",userData.pseudo]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Personnage Pr\\xE9f\\xE9r\\xE9: \",userData.personnage]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"R\\xE9gion: \",userData.area]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Boutique: \",userData.store]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des donn\\xE9es...\"})]});};export default Profil;","map":{"version":3,"names":["React","useState","useEffect","Navigation","axios","jwtDecode","jsx","_jsx","jsxs","_jsxs","Profil","userData","setUserData","token","localStorage","getItem","console","error","removeItem","window","location","href","decodedToken","pseudo","get","headers","Authorization","then","response","data","catch","children","className","username","firstname","personnage","area","store"],"sources":["C:/Users/plich/Desktop/projet-complet-one-piece/projet-front-end-one-piece/src/pages/Profil.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Navigation from \"../components/Navigation\";\r\nimport axios from \"axios\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\n\r\nconst Profil = () => {\r\n  const [userData, setUserData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    if (!token) {\r\n      // Si aucun token, redirige vers la page de connexion ou traite l'absence de token\r\n      console.error(\r\n        \"Aucun token trouvé, redirection vers la page de connexion\"\r\n      );\r\n      localStorage.removeItem(\"token\");\r\n      window.location.href = \"/connexion\";\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const decodedToken = jwtDecode(token);\r\n      const pseudo = decodedToken.pseudo;\r\n\r\n      // Exemple de vérification du token\r\n      axios\r\n        .get(`http://192.168.1.16:3001/user/${pseudo}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        })\r\n        .then((response) => {\r\n          setUserData(response.data);\r\n        })\r\n        .catch((error) => {\r\n          console.error(\"Erreur lors de la récupération du profil:\", error);\r\n          localStorage.removeItem(\"token\");\r\n          window.location.href = \"/connexion\";\r\n        });\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du décodage du token:\", error);\r\n      localStorage.removeItem(\"token\");\r\n      window.location.href = \"/connexion\";\r\n    }\r\n  }, []); // Dépendances vides, s'exécute une seule fois au montage du composant\r\n\r\n  // Afficher les informations de l'utilisateur\r\n  return (\r\n    <div>\r\n      <Navigation />\r\n      <h1>Profil</h1>\r\n      {userData ? (\r\n        <div className=\"profil\">\r\n          <p>Nom: {userData.username}</p>\r\n          <p>Prénom: {userData.firstname}</p>\r\n          <p>Pseudo: {userData.pseudo}</p>\r\n          <p>Personnage Préféré: {userData.personnage}</p>\r\n          <p>Région: {userData.area}</p>\r\n          <p>Boutique: {userData.store}</p>\r\n        </div>\r\n      ) : (\r\n        <p>Chargement des données...</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profil;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEvC,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CACnB,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CAE9CC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAW,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CAACF,KAAK,CAAE,CACV;AACAG,OAAO,CAACC,KAAK,CACX,2DACF,CAAC,CACDH,YAAY,CAACI,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,YAAY,CACnC,OACF,CAEA,GAAI,CACF,KAAM,CAAAC,YAAY,CAAGjB,SAAS,CAACQ,KAAK,CAAC,CACrC,KAAM,CAAAU,MAAM,CAAGD,YAAY,CAACC,MAAM,CAElC;AACAnB,KAAK,CACFoB,GAAG,CAAC,iCAAiCD,MAAM,EAAE,CAAE,CAC9CE,OAAO,CAAE,CACPC,aAAa,CAAE,UAAUb,KAAK,EAChC,CACF,CAAC,CAAC,CACDc,IAAI,CAAEC,QAAQ,EAAK,CAClBhB,WAAW,CAACgB,QAAQ,CAACC,IAAI,CAAC,CAC5B,CAAC,CAAC,CACDC,KAAK,CAAEb,KAAK,EAAK,CAChBD,OAAO,CAACC,KAAK,CAAC,2CAA2C,CAAEA,KAAK,CAAC,CACjEH,YAAY,CAACI,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,YAAY,CACrC,CAAC,CAAC,CACN,CAAE,MAAOJ,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAEA,KAAK,CAAC,CACzDH,YAAY,CAACI,UAAU,CAAC,OAAO,CAAC,CAChCC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,YAAY,CACrC,CACF,CAAC,CAAE,EAAE,CAAC,CAAE;AAER;AACA,mBACEZ,KAAA,QAAAsB,QAAA,eACExB,IAAA,CAACJ,UAAU,GAAE,CAAC,cACdI,IAAA,OAAAwB,QAAA,CAAI,QAAM,CAAI,CAAC,CACdpB,QAAQ,cACPF,KAAA,QAAKuB,SAAS,CAAC,QAAQ,CAAAD,QAAA,eACrBtB,KAAA,MAAAsB,QAAA,EAAG,OAAK,CAACpB,QAAQ,CAACsB,QAAQ,EAAI,CAAC,cAC/BxB,KAAA,MAAAsB,QAAA,EAAG,aAAQ,CAACpB,QAAQ,CAACuB,SAAS,EAAI,CAAC,cACnCzB,KAAA,MAAAsB,QAAA,EAAG,UAAQ,CAACpB,QAAQ,CAACY,MAAM,EAAI,CAAC,cAChCd,KAAA,MAAAsB,QAAA,EAAG,+BAAoB,CAACpB,QAAQ,CAACwB,UAAU,EAAI,CAAC,cAChD1B,KAAA,MAAAsB,QAAA,EAAG,aAAQ,CAACpB,QAAQ,CAACyB,IAAI,EAAI,CAAC,cAC9B3B,KAAA,MAAAsB,QAAA,EAAG,YAAU,CAACpB,QAAQ,CAAC0B,KAAK,EAAI,CAAC,EAC9B,CAAC,cAEN9B,IAAA,MAAAwB,QAAA,CAAG,8BAAyB,CAAG,CAChC,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAArB,MAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}